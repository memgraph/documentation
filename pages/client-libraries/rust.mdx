import { Callout } from 'nextra/components'
import { Steps } from 'nextra/components'


# Rust client guide 

## Quickstart 

Learn how to create a Rust application that connects to the Memgraph database and executes simple queries. 
This will introduce you to the basics of Memgraph and the Rust driver. 
This guide is based on the Memgraph Rust driver [rsmgclient](https://github.com/memgraph/rsmgclient).

Keep in mind that if you are already using [neo4rs](https://github.com/neo4j-labs/neo4rs), you can use Neo4j driver with Memgraph, since Memgraph is compatible with Neo4j drivers.

<Callout type="info"> 
Prerequisite for following this guides is installed [Rust programming language](https://www.rust-lang.org/tools/install) and [Docker](https://docs.docker.com/get-docker/) in your local environment. 
</Callout>



<Steps>
### Run Memgraph 

You can by running Memgraph in background. The easiest way is to use Docker image, start the container with the following command:

```bash
docker run -it -p 7687:7687 -p 7444:7444 -p 3000:3000 memgraph/memgraph-platform
```
This will start Memgraph platform, that includes, Memgraph database, Memgraph Lab and Memgraph MAGE. Memgraph uses Bolt protocol to communicate with the client, 
for that you need to expose the port 7687. Memgraph Lab is a web application that you can use to visualize your data, it is available on port 3000, and port 7444 is used for
logs that are visible in the Memgraph Lab.

### Create a directory for your project 

Start by creating a new project directory and positioning yourself in it:

```bash
mkdir hello-memgraph
cd hello-memgraph
```

### Create a new Rust project

If Rust is properly installed, you can create a new Rust project with the following command:

```bash
cargo new hello-memgraph
```

This will create a new directory called `hello-memgraph` with the following structure:

```bash
hello-memgraph
├── Cargo.toml
└── src
    └── main.rs
```

### Add rsmgclient dependency

To use the rsmgclient driver, you need to add it to the `Cargo.toml` file under the line `[dependencies]`:

```toml
rsmgclient = "2.0.1"
```

### Create a Rust program




</Steps>

# Rust quick start

At the end of this guide, you will have created a Rust program that connects to the Memgraph database and executes simple
queries.

## Prerequisites

To follow this guide, you will need:

- A **running Memgraph instance**. If you need to set up Memgraph, take a look
  at the [Installation guide](/getting-started/install-memgraph).
- A locally installed [**rsmgclient
  driver**](https://github.com/memgraph/rsmgclient).


## Basic setup

Let's jump in and connect a simple program to connect to Memgraph.

**1.** Create a new Rust project with the name **memgraph_rust** by running the
following command:

```
cargo new memgraph_rust --bin
```

**2.** Add the following line to the `Cargo.toml` file under the line
`[dependencies]` :

```
rsmgclient = "2.0.0"
```

**3.** To create the actual program, add the following code to the `src/main.rs`
file:

```rust
use rsmgclient::{ConnectParams, Connection, MgError, Value, SSLMode};

fn execute_query() -> Result<(), MgError> {
    // Connect to Memgraph.
    let connect_params = ConnectParams {
        host: Some(String::from("localhost")),
        port: 7687,
        sslmode: SSLMode::Disable,
        ..Default::default()
    };
    let mut connection = Connection::connect(&connect_params)?;



    // Create simple graph.
    connection.execute_without_results(
        "CREATE (p1:Person {name: 'Alice'})-[l1:Likes]->(m:Software {name: 'Memgraph'}) \
         CREATE (p2:Person {name: 'John'})-[l2:Likes]->(m);",
    )?;

    // Fetch the graph.
    let columns = connection.execute("MATCH (n)-[r]->(m) RETURN n, r, m;", None)?;
    println!("Columns: {}", columns.join(", "));
    for record in connection.fetchall()? {
        for value in record.values {
            match value {
                Value::Node(node) => print!("{}", node),
                Value::Relationship(edge) => print!("-{}-", edge),
                value => print!("{}", value),
            }
        }
        println!();
    }
    connection.commit()?;

    Ok(())
}

fn main() {
    
    if let Err(error) = execute_query() {
        panic!("{}", error)
    }
}
```

**4.** Open a terminal, position yourself in the project root directory `/memgraph_rust` and run:
``` 
cargo build
```
and after that:
```
cargo run
```

You should see an output similar to the following:

```
Columns: n, r, m
(:Person {'name': 'Alice'})-[:Likes {}]-(:Software {'name': 'Memgraph'})
(:Person {'name': 'John'})-[:Likes {}]-(:Software {'name': 'Memgraph'})
``````