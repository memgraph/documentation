---
title: Auth module errors
description: Enhance your graph journey with advanced authentication features, and learn how to implement strong authentication mechanisms for enhanced security. 
---

import { Callout } from 'nextra/components'
import {CommunityLinks} from '/components/social-card/CommunityLinks'


# Auth module errors

## Errors

1. ["Couldn't authenticate user '{}' because the role '{}' doesn't exist."](#error-1)
2. ["Couldn't authenticate user '{}' because the password is not correct."](#error-1)
3. ["Operation not permitted when using an authentication module."](#error-2)
4. ["Using auth module, no role '{}' found."](#error-1)
5. [Couldn't authenticate user '{}' because the user doesn't exist. For more
   details, visit: memgr.ph/auth.](#error-2)
6. [Couldn't authenticate user '{}'. For more details, visit:
   memgr.ph/auth.](#error-1)
7. ["No user nor role '{}' found."](#error-1)


## Couldn't authenticate user [#error-1]

A user authentication can fail for many reasons. The user could be missing, 
the wrong password might be entered, the role defined by the auth module might
be missing.

## Operation not permitted when using auth module [#error-4]

Queries that modify a user's authentication data are forbidden while using 
an auth module. Users are handled by the module and local users are disabled.

## User doesn't have AUTH privilege

This error occurs when a user attempts to execute authentication or authorization queries (such as `CREATE USER`, `CREATE ROLE`, `GRANT`, `DENY`, `REVOKE`, etc.) without the required `AUTH` privilege.

{<h3 className="custom-header">Solution</h3>}

Grant the `AUTH` privilege to the user or their role:

```cypher
-- Grant AUTH privilege to a user
GRANT AUTH TO username;

-- Grant AUTH privilege to a role
GRANT AUTH TO role_name;
```

{<h3 className="custom-header">Multi-tenant environments</h3>}

In multi-tenant environments, users must also have access to the default "memgraph" database to execute authentication and authorization queries. See the [authentication requirements documentation](/database-management/authentication-and-authorization/role-based-access-control#authentication-and-authorization-requirements) for more details.

## User doesn't have access to the memgraph database [#error-4]

This error occurs in multi-tenant environments when a user attempts to execute authentication or authorization queries but doesn't have access to the default "memgraph" database.

{<h3 className="custom-header">Solution</h3>}

Grant access to the "memgraph" database to the user or their role:

```cypher
-- Grant access to memgraph database for a user
GRANT DATABASE memgraph TO username;

-- Grant access to memgraph database for a role
GRANT DATABASE memgraph TO role_name;
```

{<h3 className="custom-header">Best practice</h3>}

In multi-tenant environments, we recommend treating the "memgraph" database as an administrative/system database and restricting access to privileged users only. See the [multi-tenancy documentation](/database-management/multi-tenancy#default-database-best-practices) for recommended setup patterns.

## Database context must be specified for SHOW ROLE in multi-tenant environment

This error occurs when attempting to use `SHOW ROLE` or `SHOW ROLES` in a multi-tenant environment without specifying the database context.

**Note**: This error should no longer occur for `SHOW ROLE FOR USER` commands, as they no longer require database specification. The `SHOW ROLE FOR USER` command will show all roles assigned to the user across all databases.

{<h3 className="custom-header">Solution</h3>}

For `SHOW ROLE FOR USER` commands, you can use them without database specification:

```cypher
-- Show all roles for a user (works in all environments)
SHOW ROLE FOR user_name;
SHOW ROLES FOR user_name;
```

If you need to see roles in a specific database context, you can optionally specify:

```cypher
-- Show roles for the user's main database
SHOW ROLE FOR user_name ON MAIN;

-- Show roles for the current database
SHOW ROLE FOR user_name ON CURRENT;

-- Show roles for a specific database
SHOW ROLE FOR user_name ON DATABASE database_name;
```

{<h3 className="custom-header">When this occurs</h3>}

This error typically occurs when:
- The system detects multiple databases and requires explicit context specification
- The user is connected to a multi-tenant Memgraph instance

## Database context must be specified for SHOW PRIVILEGES in multi-tenant environment [#error-9]

This error occurs when attempting to use `SHOW PRIVILEGES` in a multi-tenant environment without specifying the database context.

**Note**: This error only occurs for `SHOW PRIVILEGES FOR USER` commands. The `SHOW PRIVILEGES FOR ROLE` command does not require database specification and will show all privileges for the role.

{<h3 className="custom-header">Solution</h3>}

For `SHOW PRIVILEGES FOR ROLE` commands, you can use them without database specification:

```cypher
-- Show all privileges for a role (works in all environments)
SHOW PRIVILEGES FOR role_name;
```

For `SHOW PRIVILEGES FOR USER` commands in multi-tenant environments, you must specify the database context:

```cypher
-- Show privileges for the user's main database
SHOW PRIVILEGES FOR user_name ON MAIN;

-- Show privileges for the current database
SHOW PRIVILEGES FOR user_name ON CURRENT;

-- Show privileges for a specific database
SHOW PRIVILEGES FOR user_name ON DATABASE database_name;
```

{<h3 className="custom-header">When this occurs</h3>}

This error typically occurs when:
- Running `SHOW PRIVILEGES FOR USER` in a multi-tenant environment
- The system detects multiple databases and requires explicit context specification for users
- The user is connected to a multi-tenant Memgraph instance

{<h3 className="custom-header">Best practice</h3>}

- For roles: Use `SHOW PRIVILEGES FOR role_name` without database specification
- For users: Always specify the database context when working in multi-tenant environments to ensure you're viewing the correct privileges for the intended database

## User doesn't have REPLICATION privilege

This error occurs when a user attempts to execute replication queries (such as `REGISTER REPLICA`, `SHOW REPLICAS`, `DROP REPLICA`, etc.) without the required `REPLICATION` privilege.

{<h3 className="custom-header">Solution</h3>}

Grant the `REPLICATION` privilege to the user or their role:

```cypher
-- Grant REPLICATION privilege to a user
GRANT REPLICATION TO username;

-- Grant REPLICATION privilege to a role
GRANT REPLICATION TO role_name;
```

{<h3 className="custom-header">Multi-tenant environments</h3>}

In multi-tenant environments, users must also have access to the default "memgraph" database to execute replication queries. See the [replication documentation](/clustering/replication#replication-queries-and-the-memgraph-database) for more details.

## User doesn't have MULTI_DATABASE_USE privilege [#error-6]

This error occurs when a user attempts to execute multi-database queries (such as `SHOW DATABASES`, `USE DATABASE`) without the required `MULTI_DATABASE_USE` privilege.

{<h3 className="custom-header">Solution</h3>}

Grant the `MULTI_DATABASE_USE` privilege to the user or their role:

```cypher
-- Grant MULTI_DATABASE_USE privilege to a user
GRANT MULTI_DATABASE_USE TO username;

-- Grant MULTI_DATABASE_USE privilege to a role
GRANT MULTI_DATABASE_USE TO role_name;
```

{<h3 className="custom-header">Multi-tenant environments</h3>}

In multi-tenant environments, users must also have access to the default "memgraph" database to execute multi-database queries. See the [multi-tenancy documentation](/database-management/multi-tenancy#multi-database-queries-and-the-memgraph-database) for more details.

## User doesn't have MULTI_DATABASE_EDIT privilege [#error-7]

This error occurs when a user attempts to execute multi-database management queries (such as `CREATE DATABASE`, `DROP DATABASE`) without the required `MULTI_DATABASE_EDIT` privilege.

{<h3 className="custom-header">Solution</h3>}

Grant the `MULTI_DATABASE_EDIT` privilege to the user or their role:

```cypher
-- Grant MULTI_DATABASE_EDIT privilege to a user
GRANT MULTI_DATABASE_EDIT TO username;

-- Grant MULTI_DATABASE_EDIT privilege to a role
GRANT MULTI_DATABASE_EDIT TO role_name;
```

{<h3 className="custom-header">Multi-tenant environments</h3>}

In multi-tenant environments, users must also have access to the default "memgraph" database to execute multi-database management queries. See the [multi-tenancy documentation](/database-management/multi-tenancy#multi-database-queries-and-the-memgraph-database) for more details.


<CommunityLinks/>