---
title: Setup multi-tenancy
description: Learn how to set up multi-tenancy in Memgraph, including user main database, configuration flags, and connecting to databases.
---

import { Callout } from 'nextra/components'

# Setup multi-tenancy

## User's main database

Administrators assign default databases to users, ensuring a seamless and secure
connection experience. Users cannot connect to Memgraph if they lack access
rights to their default database. This situation may arise from database
deletion or revoked access rights.

## Configuration flags

The `data-recovery-on-startup` flag replaces `storage-recover-on-startup`,
facilitating recovery of individual databases and their contents during startup.

## Connecting to a database

The user can interact with multi-tenant databases in two ways:

1. Through Cypher queries.
2. When using Neo4j drivers, by defining the `database` field. 
   The `USE DATABASE` query is disabled when the database field is defined. 
   All queries run against the specified database only.

When connecting to Memgraph without defining a particular landing database, 
you will be connected to the default database set for the user. In case the user
does not have a default (main) database, a database-less connection will be 
established. During this connection, the user can execute queries that do not 
manipulate any data. User can still use multi-tenant queries and define a 
database to use via the appropriate Cypher query.

Example using Neo4j Python driver:

```python
import neo4j

driver = neo4j.GraphDatabase.driver("bolt://localhost:7687", auth=("user", "pass"))

with driver.session() as session:
    session.run(...)  # Executes on the default database
    session.run("USE DATABASE db1")
    session.run(...)  # Executes on db1

with driver.session(database="db2") as session:
    session.run(...)  # Executes on db2
    session.run("USE DATABASE db1")  # Error: database switching disabled
```

