---
title: Authentication and authorization
description: Manage users and roles, implement role-based and fine-grained access control and learn how to integrate with other authentication systems.
---

#  Authentication and authorization

Learn how authentication and authorization works in Memgraph. Manage users and
roles, secure the database with role-based and fine-grained access control and
learn how to integrate with other authentication systems.

## Recent changes to authentication requirements

Recent updates to Memgraph have introduced new requirements for authentication and authorization operations, particularly affecting multi-tenant environments:

### AUTH privilege requirement

Authentication and authorization queries (such as `CREATE USER`, `CREATE ROLE`, `GRANT`, `DENY`, `REVOKE`, etc.) now require the `AUTH` privilege. Users must be explicitly granted this privilege to perform user and role management operations.

### Default database access requirement

In addition to the `AUTH` privilege, users must also have access to the default "memgraph" database to execute authentication and authorization queries. This requirement applies even when the user is working in other databases within a multi-tenant environment.

### Replication and multi-database queries

Replication queries (such as `REGISTER REPLICA`, `SHOW REPLICAS`, `DROP REPLICA`, etc.) and multi-database queries (such as `SHOW DATABASES`, `CREATE DATABASE`, `DROP DATABASE`, etc.) also now target the "memgraph" database and require access to it.

To execute these queries, users must have:
- The appropriate privileges (`REPLICATION`, `MULTI_DATABASE_EDIT`)
- Access to the default "memgraph" database

## Multi-tenant query syntax changes

Recent changes to Memgraph have modified the syntax for certain queries in multi-tenant environments. The behavior differs between users and roles:

### SHOW ROLE syntax in multi-tenant environments

**SHOW ROLE FOR USER**: This command does not require database specification and will show all roles assigned to the user across all databases.

```cypher
-- Show all roles for a user (works in all environments)
SHOW ROLE FOR user_name;
SHOW ROLES FOR user_name;
```

If you need to see roles in a specific database context, you can optionally specify:

1. **Show roles for the user's main database:**
```cypher
SHOW ROLE FOR user_name ON MAIN;
```

2. **Show roles for the current database:**
```cypher
SHOW ROLE FOR user_name ON CURRENT;
```

3. **Show roles for a specific database:**
```cypher
SHOW ROLE FOR user_name ON DATABASE database_name;
```

### SHOW PRIVILEGES syntax in multi-tenant environments

**SHOW PRIVILEGES FOR ROLE**: This command does not require database specification and will show all privileges for the role.

```cypher
-- Show all privileges for a role (works in all environments)
SHOW PRIVILEGES FOR role_name;
```

**SHOW PRIVILEGES FOR USER**: In multi-tenant environments, you must specify the database context:

1. **Show privileges for the user's main database:**
```cypher
SHOW PRIVILEGES FOR user_name ON MAIN;
```

2. **Show privileges for the current database:**
```cypher
SHOW PRIVILEGES FOR user_name ON CURRENT;
```

3. **Show privileges for a specific database:**
```cypher
SHOW PRIVILEGES FOR user_name ON DATABASE database_name;
```

These commands return the aggregated roles and privileges for the user in the specified database context. The `ON MAIN` option shows information for the user's main database, `ON CURRENT` shows information for whatever database is currently active, and `ON DATABASE` shows information for the explicitly specified database.

### Multi-tenant recommendations

For multi-tenant environments, we recommend:
- Treating the default "memgraph" database as an administrative/system database
- Restricting access to the "memgraph" database to privileged users only
- Storing application data in tenant-specific databases
- Ensuring users who need to perform authentication, replication, or multi-database operations have appropriate access

For detailed information about these requirements and best practices, see the [Role-based access control](/database-management/authentication-and-authorization/role-based-access-control#authentication-and-authorization-requirements), [Multi-tenancy](/database-management/multi-tenancy#default-database-best-practices), and [Replication](/clustering/replication#replication-queries-and-the-memgraph-database) documentation.

## [Users](/database-management/authentication-and-authorization/users)

Learn how to manage users in Memgraph.

## [Role-based access control](/database-management/authentication-and-authorization/role-based-access-control) (Enterprise)

Learn how to manage roles, set up their privileges and fine-grained access control. 

## [Multiple roles per user and multi-tenant roles](/database-management/authentication-and-authorization/multiple-roles) (Enterprise)

Learn how to assign multiple roles to users simultaneously and understand how permissions are combined from all roles.

## [Auth system integrations](/database-management/authentication-and-authorization/auth-system-integrations) (Enterprise)

Learn how to integrate with third-party auth systems and manage user
authentication and access control using Memgraph's auth module. 

## [Impersonate user](/database-management/authentication-and-authorization/impersonate-user) (Enterprise)

Learn how the impersonate user feature enables authorized users to execute
queries with the full permissions and context of another user.